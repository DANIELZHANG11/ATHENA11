# =============================================================================
# 雅典娜 API 环境变量配置
# 复制此文件为 .env 并修改配置
# =============================================================================

# -----------------------------------------------------------------------------
# 应用配置
# -----------------------------------------------------------------------------
APP_NAME=Athena
APP_ENV=development
DEBUG=true
LOG_LEVEL=DEBUG

# API 服务
API_HOST=0.0.0.0
API_PORT=48000
API_WORKERS=1
API_RELOAD=true

# CORS 配置 (逗号分隔)
CORS_ORIGINS=http://localhost:48173,http://localhost:3000

# -----------------------------------------------------------------------------
# 数据库配置 (PostgreSQL + pgvector)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql+asyncpg://athena:athena_dev_password@localhost:45432/athena
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_ECHO=false

# 同步数据库 URL (用于 Alembic 迁移)
DATABASE_URL_SYNC=postgresql://athena:athena_dev_password@localhost:45432/athena

# -----------------------------------------------------------------------------
# 缓存配置 (Valkey/Redis)
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:46379/0
CELERY_BROKER_URL=redis://localhost:46379/1
CELERY_RESULT_BACKEND=redis://localhost:46379/2

# -----------------------------------------------------------------------------
# 对象存储配置 (MinIO S3)
# -----------------------------------------------------------------------------
MINIO_ENDPOINT=localhost:48333
MINIO_ACCESS_KEY=athena_access_key
MINIO_SECRET_KEY=athena_secret_key
MINIO_SECURE=false
MINIO_BUCKET_BOOKS=athena-books
MINIO_BUCKET_COVERS=athena-covers
MINIO_BUCKET_OCR=athena-ocr

# -----------------------------------------------------------------------------
# 认证配置 (JWT)
# -----------------------------------------------------------------------------
# 重要: PowerSync 使用相同的 secret
AUTH_SECRET=dev_powersync_secret_change_in_production_must_be_256_bits_long
AUTH_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
REFRESH_TOKEN_EXPIRE_DAYS=30

# 验证码配置
AUTH_CODE_EXPIRE_MINUTES=10
AUTH_CODE_MAX_ATTEMPTS=5

# -----------------------------------------------------------------------------
# PowerSync 配置
# -----------------------------------------------------------------------------
POWERSYNC_URL=http://localhost:48090
POWERSYNC_JWT_SECRET=${AUTH_SECRET}
POWERSYNC_UPLOAD_ENABLED=true

# -----------------------------------------------------------------------------
# Celery Worker 配置
# -----------------------------------------------------------------------------
CELERY_WORKER_CONCURRENCY=4
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=360

# -----------------------------------------------------------------------------
# OCR 配置
# -----------------------------------------------------------------------------
OCR_ENABLED=true
OCR_GPU_ENABLED=false
OCR_MAX_PAGES=2000
OCR_TIMEOUT_SECONDS=1800

# -----------------------------------------------------------------------------
# AI 配置 (OpenAI Compatible)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=your_openai_api_key
OPENAI_API_BASE=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536

# -----------------------------------------------------------------------------
# 邮件配置 (SMTP)
# -----------------------------------------------------------------------------
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@athena.app
SMTP_PASSWORD=your_smtp_password
SMTP_FROM=Athena <noreply@athena.app>
SMTP_TLS=true

# -----------------------------------------------------------------------------
# Stripe 支付配置
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY=sk_test_xxx
STRIPE_WEBHOOK_SECRET=whsec_xxx
STRIPE_PRICE_PRO_MONTHLY=price_xxx
STRIPE_PRICE_PRO_YEARLY=price_xxx

# -----------------------------------------------------------------------------
# 配额配置
# -----------------------------------------------------------------------------
FREE_STORAGE_QUOTA_MB=500
FREE_BOOK_LIMIT=50
FREE_OCR_PAGES_MONTHLY=100
PRO_STORAGE_QUOTA_MB=10240
PRO_BOOK_LIMIT=1000
