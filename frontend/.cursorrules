# é›…å…¸å¨œ (Athena) - AI ç¼–ç è§„åˆ™
# æœ¬æ–‡ä»¶å®šä¹‰ AI ä»£ç ç”Ÿæˆçš„å¼ºåˆ¶è§„èŒƒï¼Œè¿åå°†å¯¼è‡´ CI å¤±è´¥

## æ ¸å¿ƒæ¶æ„

é›…å…¸å¨œæ˜¯ä¸€æ¬¾**ç¦»çº¿ä¼˜å…ˆé˜…è¯»åº”ç”¨**ï¼Œé‡‡ç”¨ä»¥ä¸‹æŠ€æœ¯æ ˆï¼š
- **è·¨å¹³å°**: Expo + Tamagui + Solito + Next.js (Monorepo)
- **æ•°æ®åŒæ­¥**: SQLite + PowerSync
- **è®¾è®¡ç³»ç»Ÿ**: Tamagui Tokens (Apple HIG å¯¹é½)

## ğŸš« ä¸¥ç¦æ¸…å• (NEVER DO)

### 1. ä¸¥ç¦ç¡¬ç¼–ç æ ·å¼å€¼

```typescript
// âŒ é”™è¯¯ - ç¡¬ç¼–ç é¢œè‰²
<View style={{ backgroundColor: '#007AFF' }} />
<Text style={{ color: 'rgba(0,0,0,0.6)' }} />

// âœ… æ­£ç¡® - ä½¿ç”¨ Token
<View backgroundColor="$systemBlue" />
<Text color="$labelSecondary" />
```

```typescript
// âŒ é”™è¯¯ - ç¡¬ç¼–ç åƒç´ å€¼
<View style={{ padding: 16, borderRadius: 12 }} />
<Text style={{ fontSize: 17 }} />

// âœ… æ­£ç¡® - ä½¿ç”¨ Token
<View padding="$4" borderRadius="$md" />
<Text fontSize="$body" />
```

### 2. ä¸¥ç¦ç›´æ¥ä½¿ç”¨ REST API è·å–æ•°æ®æ¸²æŸ“ UI

```typescript
// âŒ é”™è¯¯ - useEffect + fetch æ¨¡å¼
function BookList() {
  const [books, setBooks] = useState([])
  useEffect(() => {
    fetch('/api/v1/books').then(res => res.json()).then(setBooks)
  }, [])
  return books.map(book => <BookCard {...book} />)
}

// âœ… æ­£ç¡® - ä½¿ç”¨ PowerSync Live Query
function BookList() {
  const books = useLiveQuery<Book>(
    'SELECT * FROM books WHERE is_deleted = 0'
  )
  return books.map(book => <BookCard {...book} />)
}
```

### 3. ä¸¥ç¦å¼•å…¥é Lucide å›¾æ ‡åº“

```typescript
// âŒ é”™è¯¯ - å…¶ä»–å›¾æ ‡åº“
import { FaBook } from 'react-icons/fa'
import { IoBookOutline } from 'react-icons/io5'
import Icon from '@expo/vector-icons/MaterialIcons'

// âœ… æ­£ç¡® - ä»…ä½¿ç”¨ Lucide
import { BookOpen, Search, Settings } from 'lucide-react'        // Web
import { BookOpen, Search, Settings } from 'lucide-react-native' // Native
```

### 4. ä¸¥ç¦ç»•è¿‡ PowerSync ç›´æ¥å†™å…¥åç«¯

```typescript
// âŒ é”™è¯¯ - ç›´æ¥è°ƒç”¨ API ä¿®æ”¹æ•°æ®
await fetch(`/api/v1/books/${bookId}`, {
  method: 'PATCH',
  body: JSON.stringify({ title: newTitle })
})

// âœ… æ­£ç¡® - é€šè¿‡ PowerSync æœ¬åœ°å†™å…¥
const { execute } = useMutation()
await execute(
  'UPDATE books SET title = ?, updated_at = ? WHERE id = ?',
  [newTitle, new Date().toISOString(), bookId]
)
```

## âœ… å¿…é¡»éµå®ˆ (ALWAYS DO)

### 1. æ‰€æœ‰æ ·å¼å¿…é¡»ä½¿ç”¨ Tamagui Token

| ç±»åˆ« | Token å‰ç¼€ | ç¤ºä¾‹ |
|------|-----------|------|
| é—´è· | `$space.` æˆ– `$` | `padding="$4"`, `gap="$2"` |
| é¢œè‰² | `$color.` æˆ– `$` | `color="$label"`, `bg="$systemBlue"` |
| åœ†è§’ | `$radius.` | `borderRadius="$lg"` |
| å­—å· | `$fontSize.` | `fontSize="$body"` |
| å°ºå¯¸ | `$size.` | `height="$touchTarget"` |

### 2. å›¾æ ‡è§„èŒƒ

```typescript
// æ ‡å‡†å›¾æ ‡å±æ€§
<BookOpen 
  size={20}           // List: 20, NavBar: 22, TabBar: 24
  strokeWidth={1.5}   // Regular: 1.5, Medium: 2
  color="$systemBlue" // ä½¿ç”¨è¯­ä¹‰è‰² Token
/>
```

### 3. æŒ‰é’®ç‚¹å‡»åé¦ˆ

æ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ å¿…é¡»æœ‰è§¦è§‰åé¦ˆï¼š

```typescript
<Button
  pressStyle={{
    scale: 0.97,    // Apple æ ‡å‡†ç¼©æ”¾
    opacity: 0.8,
  }}
  animation="fast"
>
  ç‚¹å‡»æˆ‘
</Button>
```

### 4. åŠ¨ç”»ä½¿ç”¨ Spring é…ç½®

```typescript
// Apple æ ‡å‡† Spring å‚æ•°
animation="medium"  // stiffness: 170, damping: 26
```

### 5. ç»„ä»¶ä½ç½®è§„èŒƒ

| å†…å®¹ç±»å‹ | ä½ç½® |
|---------|------|
| å¯å¤ç”¨ UI ç»„ä»¶ | `packages/ui/src/` |
| ä¸šåŠ¡é€»è¾‘ Hook | `packages/app/src/hooks/` |
| PowerSync Schema | `packages/app/src/provider/powersync/schema.ts` |
| é¡µé¢ç»„ä»¶ | `apps/next/pages/` æˆ– `apps/expo/app/` |

## å­—ä½“è§„èŒƒ

- **è‹±æ–‡/æ•°å­—**: Inter
- **ä¸­æ–‡**: Noto Sans SC
- **æ­£æ–‡å­—å·**: 17px (Apple æ ‡å‡†ï¼Œä¸¥ç¦ç¼©å°)

## REST API å…è®¸åœºæ™¯

ä»…ä»¥ä¸‹åœºæ™¯å¯ä½¿ç”¨ REST APIï¼š
1. **è®¤è¯ç™»å½•**: `POST /api/v1/auth/*`
2. **æ–‡ä»¶ä¸Šä¼ **: `POST /api/v1/books/upload_init` + S3 Presigned URL
3. **AI å¯¹è¯**: `POST /api/v1/ai/chat` (SSE æµå¼)
4. **æ”¯ä»˜ç›¸å…³**: `POST /api/v1/billing/*`
5. **è§¦å‘ OCR**: `POST /api/v1/books/{id}/ocr`

## æ•°æ®æ—¶é—´æˆ³

- **å­˜å‚¨**: ç»Ÿä¸€ä½¿ç”¨ ISO 8601 UTC å­—ç¬¦ä¸² (`2025-12-23T12:00:00.000Z`)
- **æ˜¾ç¤º**: å¿…é¡»è½¬æ¢ä¸ºç”¨æˆ·æœ¬åœ°æ—¶åŒº

## è§¦æ§çƒ­åŒº

- **Mobile**: æœ€å° 44Ã—44 px
- **Desktop**: æœ€å° 32Ã—32 px
